"use strict";(self.webpackChunkapp_src=self.webpackChunkapp_src||[]).push([[7449],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>u});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var c=r.createContext({}),i=function(e){var t=r.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=i(e.components);return r.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,s=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),h=i(a),u=n,m=h["".concat(c,".").concat(u)]||h[u]||d[u]||s;return a?r.createElement(m,o(o({ref:t},p),{},{components:a})):r.createElement(m,o({ref:t},p))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=a.length,o=new Array(s);o[0]=h;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,o[1]=l;for(var i=2;i<s;i++)o[i]=a[i];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},4060:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>i});var r=a(7462),n=(a(7294),a(3905));const s={tags:["Kibana","ElasticSearch"]},o="Setup Elastic Search and Kibana Open Source",l={unversionedId:"Dev Notes/Rancher/Setup-Elastic-Search-and-Kibana-Open-Source",id:"Dev Notes/Rancher/Setup-Elastic-Search-and-Kibana-Open-Source",title:"Setup Elastic Search and Kibana Open Source",description:"https://itnext.io/elasticsearch-kibana-on-k8s-w-rancher-desktop-rancher-cluster-manager-2-6-f155c86164c0",source:"@site/docs/Dev Notes/Rancher/Setup-Elastic-Search-and-Kibana-Open-Source.md",sourceDirName:"Dev Notes/Rancher",slug:"/Dev Notes/Rancher/Setup-Elastic-Search-and-Kibana-Open-Source",permalink:"/docs/Dev Notes/Rancher/Setup-Elastic-Search-and-Kibana-Open-Source",draft:!1,tags:[{label:"Kibana",permalink:"/docs/tags/kibana"},{label:"ElasticSearch",permalink:"/docs/tags/elastic-search"}],version:"current",frontMatter:{tags:["Kibana","ElasticSearch"]},sidebar:"tutorialSidebar",previous:{title:"pi setup",permalink:"/docs/Dev Notes/OS/pi/pi-setup"},next:{title:"Tools",permalink:"/docs/category/tools"}},c={},i=[{value:"Add the Jetstack Helm repository",id:"add-the-jetstack-helm-repository",level:2},{value:"Update your local Helm chart repository cache",id:"update-your-local-helm-chart-repository-cache",level:2},{value:"Install the cert-manager Helm chart - https://cert-manager.io/docs/installation/helm/",id:"install-the-cert-manager-helm-chart---httpscert-manageriodocsinstallationhelm",level:2},{value:"Deploy Rancher Cluster Manager via helm",id:"deploy-rancher-cluster-manager-via-helm",level:2},{value:"Get Password",id:"get-password",level:2},{value:"Visit dashboard",id:"visit-dashboard",level:2},{value:"Add Elastic Repo",id:"add-elastic-repo",level:2},{value:"Set deployment for Elastic search",id:"set-deployment-for-elastic-search",level:2},{value:"Set deployment for Kibana",id:"set-deployment-for-kibana",level:2},{value:"Set Ingress",id:"set-ingress",level:2},{value:"Set Ingress for es",id:"set-ingress-for-es",level:2},{value:"Visit Kibana",id:"visit-kibana",level:2},{value:"Set port-forward at Rancher Desktop",id:"set-port-forward-at-rancher-desktop",level:2}],p={toc:i};function d(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"setup-elastic-search-and-kibana-open-source"},"Setup Elastic Search and Kibana Open Source"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"https://itnext.io/elasticsearch-kibana-on-k8s-w-rancher-desktop-rancher-cluster-manager-2-6-f155c86164c0\n")),(0,n.kt)("h2",{id:"add-the-jetstack-helm-repository"},"Add the Jetstack Helm repository"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"helm repo add jetstack https://charts.jetstack.io\n")),(0,n.kt)("h2",{id:"update-your-local-helm-chart-repository-cache"},"Update your local Helm chart repository cache"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"helm repo update\n")),(0,n.kt)("h2",{id:"install-the-cert-manager-helm-chart---httpscert-manageriodocsinstallationhelm"},"Install the cert-manager Helm chart - ",(0,n.kt)("a",{parentName:"h2",href:"https://cert-manager.io/docs/installation/helm/"},"https://cert-manager.io/docs/installation/helm/")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"helm install cert-manager jetstack/cert-manager --namespace cert-manager --create-namespace --set installCRDs=true --version v1.9.1 --wait\n")),(0,n.kt)("h2",{id:"deploy-rancher-cluster-manager-via-helm"},"Deploy Rancher Cluster Manager via helm"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'RANCHER_SERVER_HOSTNAME="rancher.localhost"\nhelm repo add rancher-latest https://releases.rancher.com/server-charts/latest\nhelm repo update\nkubectl create namespace cattle-system\nhelm install rancher rancher-latest/rancher --namespace cattle-system --set hostname=${RANCHER_SERVER_HOSTNAME} --set bootstrapPassword=admin --wait\n')),(0,n.kt)("h2",{id:"get-password"},"Get Password"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"kubectl get secret --namespace cattle-system bootstrap-secret -o go-template='{{.data.bootstrapPassword|base64decode}}{{ \"\\n\" }}'\n")),(0,n.kt)("h2",{id:"visit-dashboard"},"Visit dashboard"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"https://rancher.localhost/\n")),(0,n.kt)("h2",{id:"add-elastic-repo"},"Add Elastic Repo"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"helm repo add elastic https://helm.elastic.co\n")),(0,n.kt)("h2",{id:"set-deployment-for-elastic-search"},"Set deployment for Elastic search"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"docker.elastic.co/elasticsearch/elasticsearch-oss:7.10.2\n")),(0,n.kt)("p",null,"Update the ports to open 9200 and 9300 and be sure to set the service type to Cluster IP\nAdd the env var"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"discovery.type=single-node\n")),(0,n.kt)("h2",{id:"set-deployment-for-kibana"},"Set deployment for Kibana"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"docker.elastic.co/kibana/kibana-oss:7.10.2\n")),(0,n.kt)("p",null,"Update the ports to open 5601 \u2014 set the service type to Cluster IP\nSet an env var for"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"ELASTICSEARCH_HOSTS=http://es:9200\n")),(0,n.kt)("h2",{id:"set-ingress"},"Set Ingress"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"Namespace: es\nName: kibana.rancher.localhost\nRules.Request Host: kibana.rancher.localhost\nRules.Pods.Path: /\nRules.Pods.Target Service: kibana (select)\nRules.Pods.Port: 5601 (select)\n")),(0,n.kt)("h2",{id:"set-ingress-for-es"},"Set Ingress for es"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"es.rancher.localhost\nPort 9200\n")),(0,n.kt)("h2",{id:"visit-kibana"},"Visit Kibana"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"http://kibana.rancher.localhost\n")),(0,n.kt)("h2",{id:"set-port-forward-at-rancher-desktop"},"Set port-forward at Rancher Desktop"),(0,n.kt)("p",null,"Set according to ES and Kibana"))}d.isMDXComponent=!0}}]);